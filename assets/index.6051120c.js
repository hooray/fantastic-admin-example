
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * https://fantastic-admin.netlify.app
 * 代码仓库
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
    
import{v as e,d as t,y as a,L as n,M as l,r as o,N as r,c as i,A as s,o as u,O as c,C as f,b as d,f as p,D as v,l as h,h as m,w as y,P as b,i as g,m as k,n as w,H as O,Q as _,R as K,S as x,U as C,E as j,e as E,G as S,I as P,J as L}from"./index.edceb537.js";import{E as T}from"./el-input.7941ab17.js";import{e as A}from"./eventBus.4bd846bd.js";var B="undefined"!=typeof navigator&&navigator.userAgent.toLowerCase().indexOf("firefox")>0;function I(e,t,a,n){e.addEventListener?e.addEventListener(t,a,n):e.attachEvent&&e.attachEvent("on".concat(t),(function(){a(window.event)}))}function M(e,t){for(var a=t.slice(0,t.length-1),n=0;n<a.length;n++)a[n]=e[a[n].toLowerCase()];return a}function D(e){"string"!=typeof e&&(e="");for(var t=(e=e.replace(/\s/g,"")).split(","),a=t.lastIndexOf("");a>=0;)t[a-1]+=",",t.splice(a,1),a=t.lastIndexOf("");return t}for(var N={backspace:8,tab:9,clear:12,enter:13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,ins:45,insert:45,home:36,end:35,pageup:33,pagedown:34,capslock:20,num_0:96,num_1:97,num_2:98,num_3:99,num_4:100,num_5:101,num_6:102,num_7:103,num_8:104,num_9:105,num_multiply:106,num_add:107,num_enter:108,num_subtract:109,num_decimal:110,num_divide:111,"⇪":20,",":188,".":190,"/":191,"`":192,"-":B?173:189,"=":B?61:187,";":B?59:186,"'":222,"[":219,"]":221,"\\":220},R={"⇧":16,shift:16,"⌥":18,alt:18,option:18,"⌃":17,ctrl:17,control:17,"⌘":91,cmd:91,command:91},U={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey",shiftKey:16,ctrlKey:17,altKey:18,metaKey:91},V={16:!1,18:!1,17:!1,91:!1},H={},q=1;q<20;q++)N["f".concat(q)]=111+q;var G=[],z=!1,J="all",Q=[],X=function(e){return N[e.toLowerCase()]||R[e.toLowerCase()]||e.toUpperCase().charCodeAt(0)};function F(e){J=e||"all"}function W(){return J||"all"}var Y=function(e){var t=e.key,a=e.scope,n=e.method,l=e.splitKey,o=void 0===l?"+":l;D(t).forEach((function(e){var t=e.split(o),l=t.length,r=t[l-1],i="*"===r?"*":X(r);if(H[i]){a||(a=W());var s=l>1?M(R,t):[];H[i]=H[i].filter((function(e){return!((!n||e.method===n)&&e.scope===a&&function(e,t){for(var a=e.length>=t.length?e:t,n=e.length>=t.length?t:e,l=!0,o=0;o<a.length;o++)-1===n.indexOf(a[o])&&(l=!1);return l}(e.mods,s))}))}}))};function Z(e,t,a,n){var l;if(t.element===n&&(t.scope===a||"all"===t.scope)){for(var o in l=t.mods.length>0,V)Object.prototype.hasOwnProperty.call(V,o)&&(!V[o]&&t.mods.indexOf(+o)>-1||V[o]&&-1===t.mods.indexOf(+o))&&(l=!1);(0!==t.mods.length||V[16]||V[18]||V[17]||V[91])&&!l&&"*"!==t.shortcut||!1===t.method(e,t)&&(e.preventDefault?e.preventDefault():e.returnValue=!1,e.stopPropagation&&e.stopPropagation(),e.cancelBubble&&(e.cancelBubble=!0))}}function $(e,t){var a=H["*"],n=e.keyCode||e.which||e.charCode;if(ee.filter.call(this,e)){if(93!==n&&224!==n||(n=91),-1===G.indexOf(n)&&229!==n&&G.push(n),["ctrlKey","altKey","shiftKey","metaKey"].forEach((function(t){var a=U[t];e[t]&&-1===G.indexOf(a)?G.push(a):!e[t]&&G.indexOf(a)>-1?G.splice(G.indexOf(a),1):"metaKey"===t&&e[t]&&3===G.length&&(e.ctrlKey||e.shiftKey||e.altKey||(G=G.slice(G.indexOf(a))))})),n in V){for(var l in V[n]=!0,R)R[l]===n&&(ee[l]=!0);if(!a)return}for(var o in V)Object.prototype.hasOwnProperty.call(V,o)&&(V[o]=e[U[o]]);e.getModifierState&&(!e.altKey||e.ctrlKey)&&e.getModifierState("AltGraph")&&(-1===G.indexOf(17)&&G.push(17),-1===G.indexOf(18)&&G.push(18),V[17]=!0,V[18]=!0);var r=W();if(a)for(var i=0;i<a.length;i++)a[i].scope===r&&("keydown"===e.type&&a[i].keydown||"keyup"===e.type&&a[i].keyup)&&Z(e,a[i],r,t);if(n in H)for(var s=0;s<H[n].length;s++)if(("keydown"===e.type&&H[n][s].keydown||"keyup"===e.type&&H[n][s].keyup)&&H[n][s].key){for(var u=H[n][s],c=u.splitKey,f=u.key.split(c),d=[],p=0;p<f.length;p++)d.push(X(f[p]));d.sort().join("")===G.sort().join("")&&Z(e,u,r,t)}}}function ee(e,t,a){G=[];var n=D(e),l=[],o="all",r=document,i=0,s=!1,u=!0,c="+",f=!1;for(void 0===a&&"function"==typeof t&&(a=t),"[object Object]"===Object.prototype.toString.call(t)&&(t.scope&&(o=t.scope),t.element&&(r=t.element),t.keyup&&(s=t.keyup),void 0!==t.keydown&&(u=t.keydown),void 0!==t.capture&&(f=t.capture),"string"==typeof t.splitKey&&(c=t.splitKey)),"string"==typeof t&&(o=t);i<n.length;i++)l=[],(e=n[i].split(c)).length>1&&(l=M(R,e)),(e="*"===(e=e[e.length-1])?"*":X(e))in H||(H[e]=[]),H[e].push({keyup:s,keydown:u,scope:o,mods:l,shortcut:n[i],method:a,key:n[i],splitKey:c,element:r});void 0!==r&&!function(e){return Q.indexOf(e)>-1}(r)&&window&&(Q.push(r),I(r,"keydown",(function(e){$(e,r)}),f),z||(z=!0,I(window,"focus",(function(){G=[]}),f)),I(r,"keyup",(function(e){$(e,r),function(e){var t=e.keyCode||e.which||e.charCode,a=G.indexOf(t);if(a>=0&&G.splice(a,1),e.key&&"meta"===e.key.toLowerCase()&&G.splice(0,G.length),93!==t&&224!==t||(t=91),t in V)for(var n in V[t]=!1,R)R[n]===t&&(ee[n]=!1)}(e)}),f))}var te={setScope:F,getScope:W,deleteScope:function(e,t){var a,n;for(var l in e||(e=W()),H)if(Object.prototype.hasOwnProperty.call(H,l))for(a=H[l],n=0;n<a.length;)a[n].scope===e?a.splice(n,1):n++;W()===e&&F(t||"all")},getPressedKeyCodes:function(){return G.slice(0)},isPressed:function(e){return"string"==typeof e&&(e=X(e)),-1!==G.indexOf(e)},filter:function(e){var t=e.target||e.srcElement,a=t.tagName,n=!0;return!t.isContentEditable&&("INPUT"!==a&&"TEXTAREA"!==a&&"SELECT"!==a||t.readOnly)||(n=!1),n},trigger:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"all";Object.keys(H).forEach((function(a){var n=H[a].find((function(a){return a.scope===t&&a.shortcut===e}));n&&n.method&&n.method()}))},unbind:function(e){if(void 0===e)Object.keys(H).forEach((function(e){return delete H[e]}));else if(Array.isArray(e))e.forEach((function(e){e.key&&Y(e)}));else if("object"==typeof e)e.key&&Y(e);else if("string"==typeof e){for(var t=arguments.length,a=new Array(t>1?t-1:0),n=1;n<t;n++)a[n-1]=arguments[n];var l=a[0],o=a[1];"function"==typeof l&&(o=l,l=""),Y({key:e,scope:l,method:o,splitKey:"+"})}},keyMap:N,modifier:R,modifierMap:U};for(var ae in te)Object.prototype.hasOwnProperty.call(te,ae)&&(ee[ae]=te[ae]);if("undefined"!=typeof window){var ne=window.hotkeys;ee.noConflict=function(e){return e&&window.hotkeys===ee&&(window.hotkeys=ne),ee},window.hotkeys=ee}const le=e=>(P("data-v-88f72b6e"),e=e(),L(),e),oe={class:"container"},re={key:0,class:"tips"},ie=le((()=>v("div",{class:"tip"},[v("span",null,"Alt"),K("+"),v("span",null,"S"),K(" 唤醒搜索面板 ")],-1))),se={class:"tip"},ue=K(" 切换搜索结果 "),ce={class:"tip"},fe=K(" 访问页面 "),de=le((()=>v("div",{class:"tip"},[v("span",null,"ESC"),K(" 退出 ")],-1))),pe=["href","target","onClick","onMouseover"],ve={class:"info"},he={class:"title"},me={class:"breadcrumb"},ye={class:"path"},be=t({name:"Search"}),ge=e(Object.assign(be,{setup(e){const t=a(),P=n(),L=l(),B=o(!1),I=o(""),M=o([]),D=o(-1),N=o(),R=o(),U=o([]),V=e=>U.value.push(e);r((()=>{U.value=[]}));const H=i((()=>{let e=[];return e=M.value.filter((e=>{let t=!1;return e.title.indexOf(I.value)>=0&&(t=!0),e.path.indexOf(I.value)>=0&&(t=!0),e.breadcrumb.some((e=>e.indexOf(I.value)>=0))&&(t=!0),t})),e}));function q(e){e.map((e=>{if(!1!==e.meta.sidebar)if(function(e){let t=!0;return e.children?e.children.every((e=>!1===e.meta.sidebar))&&(t=!1):t=!1,t}(e)){let t=e.meta.baseBreadcrumb?c(e.meta.baseBreadcrumb):[];t.push(e.meta.title);let a=c(e.children);a.map((a=>{a.meta.baseIcon=e.meta.icon||e.meta.baseIcon,a.meta.baseBreadcrumb=t,a.meta.basePath=e.meta.basePath?[e.meta.basePath,e.path].join("/"):e.path})),q(a)}else{let t=[];e.meta.baseBreadcrumb&&(t=c(e.meta.baseBreadcrumb)),t.push(e.meta.title);let a="";a=x(e.path)?e.path:e.meta.basePath?[e.meta.basePath,e.path].join("/"):e.path,M.value.push({icon:e.meta.icon||e.meta.baseIcon,title:e.meta.title,i18n:e.meta.i18n,breadcrumb:t,path:a})}}))}function G(){H.value.length&&(D.value-=1,D.value<0&&(D.value=H.value.length-1),Q())}function z(){H.value.length&&(D.value+=1,D.value>H.value.length-1&&(D.value=0),Q())}function J(){-1!==D.value&&U.value[D.value].click()}function Q(){let e=0;if(-1!==D.value){e=R.value.scrollTop;const t=U.value[D.value].offsetTop,a=U.value[D.value].clientHeight,n=R.value.scrollTop,l=R.value.clientHeight;t+a>n+l?e=t+a-l:t<=n&&(e=t)}R.value.scrollTo({top:e})}return s((()=>B.value),(e=>{e?(document.querySelector("body").classList.add("hidden"),R.value.scrollTop=0,ee("up",G),ee("down",z),ee("enter",J),setTimeout((()=>{N.value.focus()}),500)):(document.querySelector("body").classList.remove("hidden"),ee.unbind("up",G),ee.unbind("down",z),ee.unbind("enter",J),setTimeout((()=>{I.value="",D.value=-1}),500))})),s((()=>H.value),(()=>{D.value=-1,Q()})),u((()=>{A.on("global-search-toggle",(()=>{B.value=!B.value})),ee("alt+s",(e=>{t.topbar.enableNavSearch&&(e.preventDefault(),B.value=!0)})),ee("esc",(e=>{t.topbar.enableNavSearch&&(e.preventDefault(),B.value=!1)})),"filesystem"!==t.app.routeBaseOn?P.routes.map((e=>{q(e.children)})):L.menus.map((e=>{q(e.children)}))})),(e,a)=>{const n=C,l=j,o=T,r=f("router-link");return d(),p("div",{id:"search",class:w({searching:B.value}),onClick:a[3]||(a[3]=e=>B.value&&g(A).emit("global-search-toggle"))},[v("div",oe,[v("div",{class:"search-box",onClick:a[2]||(a[2]=h((()=>{}),["stop"]))},[m(o,{ref_key:"inputRef",ref:N,modelValue:I.value,"onUpdate:modelValue":a[0]||(a[0]=e=>I.value=e),placeholder:"搜索页面，支持标题、URL模糊查询",clearable:"",onKeydown:[a[1]||(a[1]=b((e=>g(A).emit("global-search-toggle")),["esc"])),b(h(G,["prevent"]),["up"]),b(h(z,["prevent"]),["down"]),b(h(J,["prevent"]),["enter"])]},{prefix:y((()=>[m(l,null,{default:y((()=>[m(n,{name:"ep:search"})])),_:1})])),_:1},8,["modelValue","onKeydown"]),"pc"===g(t).mode?(d(),p("div",re,[ie,v("div",se,[v("span",null,[m(l,null,{default:y((()=>[m(n,{name:"search-up"})])),_:1})]),v("span",null,[m(l,null,{default:y((()=>[m(n,{name:"search-down"})])),_:1})]),ue]),v("div",ce,[v("span",null,[m(l,null,{default:y((()=>[m(n,{name:"search-enter"})])),_:1})]),fe]),de])):k("v-if",!0)]),v("div",{ref_key:"resultRef",ref:R,class:w(["result",{mobile:"mobile"===g(t).mode}])},[(d(!0),p(O,null,_(g(H),((e,t)=>(d(),E(r,{key:e.path,custom:"",to:B.value?e.path:""},{default:y((({href:a,navigate:o})=>[v("a",{ref_for:!0,ref:V,href:g(x)(e.path)?e.path:a,class:w(["item",{actived:t===D.value}]),target:g(x)(e.path)?"_blank":"_self",onClick:o,onMouseover:e=>D.value=t},[m(l,{class:"icon"},{default:y((()=>[e.icon?(d(),E(n,{key:0,name:e.icon},null,8,["name"])):k("v-if",!0)])),_:2},1024),v("div",ve,[v("div",he,S(e.title),1),v("div",me,[(d(!0),p(O,null,_(e.breadcrumb,((e,t)=>(d(),p("span",{key:t},[K(S(e)+" ",1),m(l,null,{default:y((()=>[m(n,{name:"ep:arrow-right"})])),_:1})])))),128))]),v("div",ye,S(e.path),1)])],42,pe)])),_:2},1032,["to"])))),128))],2)])],2)}}}),[["__scopeId","data-v-88f72b6e"]]),ke=Object.freeze(Object.defineProperty({__proto__:null,default:ge},Symbol.toStringTag,{value:"Module"}));export{ge as S,ee as h,ke as i};
