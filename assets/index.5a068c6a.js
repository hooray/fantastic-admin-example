
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * https://fantastic-admin.netlify.app
 * 代码仓库
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
    
import{v as e,d as a,x as t,a1 as s,z as l,r as n,c as r,A as u,o,a2 as c,E as i,f as d,C as h,l as v,h as m,w as p,a3 as f,i as b,m as $,n as g,N as y,R as k,O as _,P as x,$ as B,D as w,L as S,I as T,b as j,e as C,M as O,S as P}from"./index.9cfebd09.js";import{E as I}from"./el-input.0f18efcc.js";import"./event.6c7ea317.js";const L=e=>(_("data-v-6d285be8"),e=e(),x(),e),D={class:"container"},E={key:0,class:"tips"},M=L((()=>h("div",{class:"tip"},[h("span",null,"Alt"),B("+"),h("span",null,"S"),B(" 唤醒搜索面板 ")],-1))),N={class:"tip"},V=B(" 切换搜索结果 "),q={class:"tip"},A=B(" 访问页面 "),H=L((()=>h("div",{class:"tip"},[h("span",null,"ESC"),B(" 退出 ")],-1))),K=["href","target","onClick","onMouseover"],R={class:"info"},U={class:"title"},z={class:"breadcrumb"},F={class:"path"},G=a({name:"Search"});var J=e(Object.assign(G,{setup(e){const{proxy:a}=w(),_=t(),x=s(),L=l(),G=n(!1),J=n(""),Q=n([]),W=n(-1),X=r((()=>{let e=[];return e=Q.value.filter((e=>{let a=!1;return e.title.indexOf(J.value)>=0&&(a=!0),e.path.indexOf(J.value)>=0&&(a=!0),e.breadcrumb.some((e=>e.indexOf(J.value)>=0))&&(a=!0),a})),e}));function Y(e){e.map((e=>{if(!1!==e.meta.sidebar)if(function(e){let a=!0;return e.children?e.children.every((e=>!1===e.meta.sidebar))&&(a=!1):a=!1,a}(e)){let a=e.meta.baseBreadcrumb?c(e.meta.baseBreadcrumb):[];a.push(e.meta.title);let t=c(e.children);t.map((t=>{t.meta.baseIcon=e.meta.icon||e.meta.baseIcon,t.meta.baseBreadcrumb=a,t.meta.basePath=e.meta.basePath?[e.meta.basePath,e.path].join("/"):e.path})),Y(t)}else{let a=[];e.meta.baseBreadcrumb&&(a=c(e.meta.baseBreadcrumb)),a.push(e.meta.title);let t="";t=S(e.path)?e.path:e.meta.basePath?[e.meta.basePath,e.path].join("/"):e.path,Q.value.push({icon:e.meta.icon||e.meta.baseIcon,title:e.meta.title,i18n:e.meta.i18n,breadcrumb:a,path:t})}}))}function Z(){X.value.length&&(W.value-=1,W.value<0&&(W.value=X.value.length-1),te())}function ee(){X.value.length&&(W.value+=1,W.value>X.value.length-1&&(W.value=0),te())}function ae(){-1!==W.value&&a.$refs[`search-item-${W.value}`][0].click()}function te(){let e=0;if(-1!==W.value){e=a.$refs.search.scrollTop;const t=a.$refs[`search-item-${W.value}`][0].offsetTop,s=a.$refs[`search-item-${W.value}`][0].clientHeight,l=a.$refs.search.scrollTop,n=a.$refs.search.clientHeight;t+s>l+n?e=t+s-n:t<=l&&(e=t)}a.$refs.search.scrollTo({top:e})}return u((()=>G.value),(e=>{e?(document.querySelector("body").classList.add("hidden"),a.$refs.search.scrollTop=0,a.$hotkeys("up",Z),a.$hotkeys("down",ee),a.$hotkeys("enter",ae),setTimeout((()=>{a.$refs.input.focus()}),500)):(document.querySelector("body").classList.remove("hidden"),a.$hotkeys.unbind("up",Z),a.$hotkeys.unbind("down",ee),a.$hotkeys.unbind("enter",ae),setTimeout((()=>{J.value="",W.value=-1}),500))})),u((()=>X.value),(()=>{W.value=-1,te()})),o((()=>{a.$eventBus.on("global-search-toggle",(()=>{G.value=!G.value})),a.$hotkeys("alt+s",(e=>{_.topbar.enableNavSearch&&(e.preventDefault(),G.value=!0)})),a.$hotkeys("esc",(e=>{_.topbar.enableNavSearch&&(e.preventDefault(),G.value=!1)})),"filesystem"!==_.app.routeBaseOn?x.routes.map((e=>{Y(e.children)})):L.menus.map((e=>{Y(e.children)}))})),(e,a)=>{const t=P,s=i,l=I,n=T("router-link");return j(),d("div",{id:"search",class:g({searching:G.value}),onClick:a[3]||(a[3]=a=>G.value&&e.$eventBus.emit("global-search-toggle"))},[h("div",D,[h("div",{class:"search-box",onClick:a[2]||(a[2]=v((()=>{}),["stop"]))},[m(l,{ref:"input",modelValue:J.value,"onUpdate:modelValue":a[0]||(a[0]=e=>J.value=e),placeholder:"搜索页面，支持标题、URL模糊查询",clearable:"",onKeydown:[a[1]||(a[1]=f((a=>e.$eventBus.emit("global-search-toggle")),["esc"])),f(v(Z,["prevent"]),["up"]),f(v(ee,["prevent"]),["down"]),f(v(ae,["prevent"]),["enter"])]},{prefix:p((()=>[m(s,null,{default:p((()=>[m(t,{name:"ep:search"})])),_:1})])),_:1},8,["modelValue","onKeydown"]),"pc"===b(_).mode?(j(),d("div",E,[M,h("div",N,[h("span",null,[m(s,null,{default:p((()=>[m(t,{name:"search-up"})])),_:1})]),h("span",null,[m(s,null,{default:p((()=>[m(t,{name:"search-down"})])),_:1})]),V]),h("div",q,[h("span",null,[m(s,null,{default:p((()=>[m(t,{name:"search-enter"})])),_:1})]),A]),H])):$("v-if",!0)]),h("div",{ref:"search",class:g(["result",{mobile:"mobile"===b(_).mode}])},[(j(!0),d(y,null,k(b(X),((e,a)=>(j(),C(n,{key:e.path,custom:"",to:G.value?e.path:""},{default:p((({href:l,navigate:n})=>[h("a",{ref_for:!0,ref:`search-item-${a}`,href:b(S)(e.path)?e.path:l,class:g(["item",{actived:a===W.value}]),target:b(S)(e.path)?"_blank":"_self",onClick:n,onMouseover:e=>W.value=a},[m(s,{class:"icon"},{default:p((()=>[e.icon?(j(),C(t,{key:0,name:e.icon},null,8,["name"])):$("v-if",!0)])),_:2},1024),h("div",R,[h("div",U,O(e.title),1),h("div",z,[(j(!0),d(y,null,k(e.breadcrumb,((e,a)=>(j(),d("span",{key:a},[B(O(e)+" ",1),m(s,null,{default:p((()=>[m(t,{name:"ep:arrow-right"})])),_:1})])))),128))]),h("div",F,O(e.path),1)])],42,K)])),_:2},1032,["to"])))),128))],2)])],2)}}}),[["__scopeId","data-v-6d285be8"]]);export{J as default};
