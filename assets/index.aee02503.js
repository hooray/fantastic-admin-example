
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * https://fantastic-admin.netlify.app
 * 代码仓库
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
    
import{v as e,d as a,z as t,a1 as s,B as l,r as n,c as r,C as u,o,a2 as c,G as i,b as d,f as h,H as m,l as v,h as p,w as f,a3 as b,i as $,m as g,n as y,N as k,R as _,$ as B,J as w,L as x,S,E as T,e as j,M as C,O,P}from"./index.84c9bfd8.js";import{E as I}from"./el-input.f69128cc.js";import"./event.d298a7ab.js";const L=e=>(O("data-v-6b6831bd"),e=e(),P(),e),E={class:"container"},H={key:0,class:"tips"},M=L((()=>m("div",{class:"tip"},[m("span",null,"Alt"),B("+"),m("span",null,"S"),B(" 唤醒搜索面板 ")],-1))),N={class:"tip"},V=B(" 切换搜索结果 "),q={class:"tip"},D=B(" 访问页面 "),K=L((()=>m("div",{class:"tip"},[m("span",null,"ESC"),B(" 退出 ")],-1))),R=["href","target","onClick","onMouseover"],U={class:"info"},z={class:"title"},A={class:"breadcrumb"},G={class:"path"},J=a({name:"Search"}),F=e(Object.assign(J,{setup(e){const{proxy:a}=w(),O=t(),P=s(),L=l(),J=n(!1),F=n(""),Q=n([]),W=n(-1),X=r((()=>{let e=[];return e=Q.value.filter((e=>{let a=!1;return e.title.indexOf(F.value)>=0&&(a=!0),e.path.indexOf(F.value)>=0&&(a=!0),e.breadcrumb.some((e=>e.indexOf(F.value)>=0))&&(a=!0),a})),e}));function Y(e){e.map((e=>{if(!1!==e.meta.sidebar)if(function(e){let a=!0;return e.children?e.children.every((e=>!1===e.meta.sidebar))&&(a=!1):a=!1,a}(e)){let a=e.meta.baseBreadcrumb?c(e.meta.baseBreadcrumb):[];a.push(e.meta.title);let t=c(e.children);t.map((t=>{t.meta.baseIcon=e.meta.icon||e.meta.baseIcon,t.meta.baseBreadcrumb=a,t.meta.basePath=e.meta.basePath?[e.meta.basePath,e.path].join("/"):e.path})),Y(t)}else{let a=[];e.meta.baseBreadcrumb&&(a=c(e.meta.baseBreadcrumb)),a.push(e.meta.title);let t="";t=x(e.path)?e.path:e.meta.basePath?[e.meta.basePath,e.path].join("/"):e.path,Q.value.push({icon:e.meta.icon||e.meta.baseIcon,title:e.meta.title,i18n:e.meta.i18n,breadcrumb:a,path:t})}}))}function Z(){X.value.length&&(W.value-=1,W.value<0&&(W.value=X.value.length-1),te())}function ee(){X.value.length&&(W.value+=1,W.value>X.value.length-1&&(W.value=0),te())}function ae(){-1!==W.value&&a.$refs[`search-item-${W.value}`][0].click()}function te(){let e=0;if(-1!==W.value){e=a.$refs.search.scrollTop;const t=a.$refs[`search-item-${W.value}`][0].offsetTop,s=a.$refs[`search-item-${W.value}`][0].clientHeight,l=a.$refs.search.scrollTop,n=a.$refs.search.clientHeight;t+s>l+n?e=t+s-n:t<=l&&(e=t)}a.$refs.search.scrollTo({top:e})}return u((()=>J.value),(e=>{e?(document.querySelector("body").classList.add("hidden"),a.$refs.search.scrollTop=0,a.$hotkeys("up",Z),a.$hotkeys("down",ee),a.$hotkeys("enter",ae),setTimeout((()=>{a.$refs.input.focus()}),500)):(document.querySelector("body").classList.remove("hidden"),a.$hotkeys.unbind("up",Z),a.$hotkeys.unbind("down",ee),a.$hotkeys.unbind("enter",ae),setTimeout((()=>{F.value="",W.value=-1}),500))})),u((()=>X.value),(()=>{W.value=-1,te()})),o((()=>{a.$eventBus.on("global-search-toggle",(()=>{J.value=!J.value})),a.$hotkeys("alt+s",(e=>{O.topbar.enableNavSearch&&(e.preventDefault(),J.value=!0)})),a.$hotkeys("esc",(e=>{O.topbar.enableNavSearch&&(e.preventDefault(),J.value=!1)})),"filesystem"!==O.app.routeBaseOn?P.routes.map((e=>{Y(e.children)})):L.menus.map((e=>{Y(e.children)}))})),(e,a)=>{const t=S,s=T,l=I,n=i("router-link");return d(),h("div",{id:"search",class:y({searching:J.value}),onClick:a[3]||(a[3]=a=>J.value&&e.$eventBus.emit("global-search-toggle"))},[m("div",E,[m("div",{class:"search-box",onClick:a[2]||(a[2]=v((()=>{}),["stop"]))},[p(l,{ref:"input",modelValue:F.value,"onUpdate:modelValue":a[0]||(a[0]=e=>F.value=e),placeholder:"搜索页面，支持标题、URL模糊查询",clearable:"",onKeydown:[a[1]||(a[1]=b((a=>e.$eventBus.emit("global-search-toggle")),["esc"])),b(v(Z,["prevent"]),["up"]),b(v(ee,["prevent"]),["down"]),b(v(ae,["prevent"]),["enter"])]},{prefix:f((()=>[p(s,null,{default:f((()=>[p(t,{name:"ep:search"})])),_:1})])),_:1},8,["modelValue","onKeydown"]),"pc"===$(O).mode?(d(),h("div",H,[M,m("div",N,[m("span",null,[p(s,null,{default:f((()=>[p(t,{name:"search-up"})])),_:1})]),m("span",null,[p(s,null,{default:f((()=>[p(t,{name:"search-down"})])),_:1})]),V]),m("div",q,[m("span",null,[p(s,null,{default:f((()=>[p(t,{name:"search-enter"})])),_:1})]),D]),K])):g("v-if",!0)]),m("div",{ref:"search",class:y(["result",{mobile:"mobile"===$(O).mode}])},[(d(!0),h(k,null,_($(X),((e,a)=>(d(),j(n,{key:e.path,custom:"",to:J.value?e.path:""},{default:f((({href:l,navigate:n})=>[m("a",{ref_for:!0,ref:`search-item-${a}`,href:$(x)(e.path)?e.path:l,class:y(["item",{actived:a===W.value}]),target:$(x)(e.path)?"_blank":"_self",onClick:n,onMouseover:e=>W.value=a},[p(s,{class:"icon"},{default:f((()=>[e.icon?(d(),j(t,{key:0,name:e.icon},null,8,["name"])):g("v-if",!0)])),_:2},1024),m("div",U,[m("div",z,C(e.title),1),m("div",A,[(d(!0),h(k,null,_(e.breadcrumb,((e,a)=>(d(),h("span",{key:a},[B(C(e)+" ",1),p(s,null,{default:f((()=>[p(t,{name:"ep:arrow-right"})])),_:1})])))),128))]),m("div",G,C(e.path),1)])],42,R)])),_:2},1032,["to"])))),128))],2)])],2)}}}),[["__scopeId","data-v-6b6831bd"]]);export{F as default};
